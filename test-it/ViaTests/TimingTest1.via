// Autogenerated Vireo assembly file
// Generated on Fri Jun 13 15:55:19 2014

// Two interleaved loops that wake up at the same time
// There once was a bug that was triggered if on clump woke
// up in the same slice that another went to sleep in 
// This test failed before the fix was applied.

define(c0 dv(.Int32 10) )
define(c1 dv(.String 'Waiting') )
define(c21 dv(.UInt32 10) )
define(c2 dv(.UInt32 20) )
define(c3 dv(.String 'Woke up') )
define(c4 dv(.UInt32 20) )
define(c5 dv(.Int32 1) )
define(c6 dv(.Int32 0) )

//---------------------------------------------------
//VI Definition: Untitled 1
define(videf1 dv(.VirtualInstrument (
    c(
        e(.Int32 local1)
        e(.Int32 local2)
        e(.Int32 local3)
        e(.Int32 local4)
        e(.Int32 local5)
        e(.Int32 local6)
        e(.UInt32 local7)
    )
        clump(1
        Trigger(1)                                // fork
//        WaitMilliseconds(c2)

//--- begin for loop
        Copy(c0 local5 )                          // set loop count
        Sub(local5 c5 local6)
        Copy(c6 local4 )                          // initialize i
        Perch(0)
        Println(c1)
        WaitMilliseconds(c4 local7)
        Println(c3)
        BranchIfGE(1 local4 local6)
        Add(local4 c5 local4)                     // increment i
        Branch(0)                                 // loop again
        Perch(1)
        Wait(1)                  // join
//--- end of vi
    )
    clump(1
//--- begin for loop
        Copy(c0 local2 )                          // set loop count
        Sub(local2 c5 local3)
        Copy(c6 local1 )                          // initialize i
        Perch(0)
        Println(c1)
        WaitMilliseconds(c2)
        Println(c3)
        BranchIfGE(1 local1 local3)
        Add(local1 c5 local1)                     // increment i
        Branch(0)                                 // loop again
        Perch(1)
    )
)))
enqueue(videf1)
