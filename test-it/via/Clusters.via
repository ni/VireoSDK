define(Rectangle c(e(.Int32 top)e(.Int32 left)e(.Int32 bottom)e(.Int32 right)))
define(StructNode c(e(.Rectangle inside)e(.Rectangle outside)))
define(RectangleWithName c(e(.Rectangle rect)e(.String name)))

define(HelloWorld dv(.VirtualInstrument
(
c(
  e(dv(.String "Hello world.") variable1)
  e(dv(.Int32 42) theAnswer)
  e(dv(.Int32 43) theAnswerPlusOne)
  e(.Rectangle   bounds)
  e(.StructNode  node2)
  e(.StructNode  node1)
  e(.RectangleWithName   rwn1)
  e(.RectangleWithName   rwn2)
  )
clump (
    Copy(node1 node2)
    Printf("initial rectangles<%z> <%z>\n" node1 node2)
    Copy(theAnswer node1.inside.top)
    Copy(theAnswer node1.outside.bottom)
    Printf ("after setting one cooordinate <%z> <%z>\n" node1 node2)
    Copy(node1.inside node2.inside)
    Printf ("after copying rectangles <%z> <%z>\n" node1 node2)
    Copy(theAnswerPlusOne node1.inside.left)
    Printf ("second field set <%z> <%z>\n" node1 node2)
    Copy(node1 node2)
    Printf ("nodes copied again <%z> <%z>\n" node1 node2)
    Copy(node1.inside node1.outside)
    Printf ("copied inside one var <%z> <%z>\n" node1 node2)
    Copy(node1 node2)
    Printf ("nodes copied again <%z> <%z>\n" node1 node2)
    Println(node1)
    Println(node2)
    Println(rwn1)
    Copy(node1.inside rwn1.rect)
    Println(rwn1)
    Copy(variable1 rwn1.name)
    Println(rwn1)
    Copy(rwn1 rwn2)
    Printf ("rwn nodes copied <%z> <%z>\n" rwn1 rwn2)
    Println(variable1)
   )
 ) ) )
enqueue(HelloWorld)
